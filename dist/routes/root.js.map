{"version":3,"sources":["../../src/routes/root.js"],"sourcesContent":["\"use strict\";\r\nvar gpio = require(\"onoff\").Gpio;\r\n//use GPIO pin numbers\r\nvar stepPins = [17, 22, 27, 23];\r\nvar pinNumber = stepPins.length;\r\nvar pins = [];\r\nvar stepCounter = 0;\r\nvar timeout = 100;\r\nvar stepCount = 9;\r\n\r\nlet Seq = [];\r\nSeq[0] = [1, 0, 0, 0];\r\nSeq[1] = [1, 1, 0, 0];\r\nSeq[2] = [0, 1, 0, 0];\r\nSeq[3] = [0, 1, 1, 0];\r\nSeq[4] = [0, 0, 1, 0];\r\nSeq[5] = [0, 0, 1, 1];\r\nSeq[6] = [0, 0, 0, 1];\r\nSeq[7] = [1, 0, 0, 1];\r\nSeq[8] = [0, 0, 0, 0];\r\n\r\nfor (var i = 0; i < pinNumber; i++) {\r\n  pins[i] = new gpio(stepPins[i], \"out\");\r\n}\r\n\r\nvar step = async function (stepCounter) {\r\n  return new Promise((res) => {\r\n    for (var pin = 0; pin < 4; pin++) {\r\n      if (Seq[stepCounter][pin] != 0) {\r\n        pins[pin].writeSync(1);\r\n      } else {\r\n        pins[pin].writeSync(0);\r\n      }\r\n    }\r\n\r\n    setTimeout(res, 5);\r\n  });\r\n};\r\n\r\nconsole.log(\"Motor Starting!!!\");\r\n\r\nconst run = async () => {\r\n  for (var s = 0; s < 50; s++) {\r\n    for (var pin = 0; pin < 9; pin++) {\r\n      await step(pin);\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = async function (fastify, opts) {\r\n  fastify.get(\"/\", async function (request, reply) {\r\n    return { root: false };\r\n  });\r\n\r\n  fastify.post(\"/1\", async function (request, reply) {\r\n    console.log(request.body);\r\n    return request.body;\r\n  });\r\n\r\n  fastify.post(\"/motor\", async function (request, reply) {\r\n    console.log(request.body);\r\n    run();\r\n    return request.body;\r\n  });\r\n\r\n  fastify.get(\"/motor\", async function (request, reply) {\r\n    run();\r\n    return request.body;\r\n  });\r\n};\r\n"],"names":["gpio","require","Gpio","stepPins","pinNumber","length","pins","stepCounter","timeout","stepCount","Seq","i","step","Promise","res","pin","writeSync","setTimeout","console","log","run","s","module","exports","fastify","opts","get","request","reply","root","post","body"],"mappings":"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"}